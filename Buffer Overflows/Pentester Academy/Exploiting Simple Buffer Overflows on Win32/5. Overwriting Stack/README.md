# Overwriting stack

**Just before the gets() function call:**

0022FE90   0022FEAE  ®þ".  \s = 0022FEAE

0022FE94   7C9101C0  À‘|  ntdll.7C9101C0

0022FE98   FFFFFFFF  ÿÿÿÿ

0022FE9C   7C9101BB  »‘|  RETURN to ntdll.7C9101BB from ntdll.7C90E8E6

0022FEA0   77C2C3C9  ÉÃÂw  RETURN to msvcrt.77C2C3C9 from ntdll.RtlAllocateHeap

0022FEA4   003E0000  ..>.

0022FEA8   FFFFFFFF  ÿÿÿÿ

0022FEAC   77C2C3CE  ÎÃÂw  RETURN to msvcrt.77C2C3CE from msvcrt.77C3745B

0022FEB0   00000065  e...

0022FEB4   003E2470  p$>.

0022FEB8   55667788  ˆwfU

0022FEBC   00404000  .@@.  ASCII "Function 1"

0022FEC0   00401F30  0@.  Overwrit.00401F30

0022FEC4   0022FEB0  °þ".

0022FEC8  /0022FEF8  øþ".

0022FECC  |0040157B  {@.  RETURN ADDRESS

---

**Corrupted gets() function:**

0022FE90   0022FEAE  ®þ".  ASCII "A123456789B123456789C123456789D123456789"

0022FE94   7C9101C0  À‘|  ntdll.7C9101C0

0022FE98   FFFFFFFF  ÿÿÿÿ

0022FE9C   7C9101BB  »‘|  RETURN to ntdll.7C9101BB from ntdll.7C90E8E6

0022FEA0   77C2C3C9  ÉÃÂw  RETURN to msvcrt.77C2C3C9 from ntdll.RtlAllocateHeap

0022FEA4   003E0000  ..>.

0022FEA8   FFFFFFFF  ÿÿÿÿ

0022FEAC   3141C3CE  ÎÃA1

0022FEB0   35343332  2345

0022FEB4   39383736  6789

0022FEB8   33323142  B123

0022FEBC   37363534  4567

0022FEC0   31433938  89C1

0022FEC4   35343332  2345

0022FEC8   39383736  6789

0022FECC   33323144  D123  RETURN ADDRESS

---

Method for guessing the offset of the return address:

A123456789B123456789C123456789....456789

.... - An offset for the RETURN ADDRESS
